<?xml version="1.0" encoding="utf-8"?>
<!-- 
    新闻详情页面布局文件
    作用：展示单条新闻的完整内容
    
    整体结构：
    1. CoordinatorLayout作为根布局，支持可折叠工具栏和滚动联动效果
    2. AppBarLayout和Toolbar构成顶部标题栏
    3. NestedScrollView实现内容区域的嵌套滚动
    4. 中部的标题、来源、日期和图片信息
    5. WebView加载新闻详情内容
    6. 页面加载进度条
    
    功能特点：
    1. 支持WebView加载HTML内容
    2. 收藏和分享功能集成在顶部工具栏
    3. 嵌套滚动支持确保平滑滚动体验
    4. 内容加载时显示进度条
-->
<androidx.coordinatorlayout.widget.CoordinatorLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <!-- 
        应用栏布局
        作用：包含顶部工具栏并支持滚动行为
        特点：
        1. 支持与内容区域的滚动联动
        2. 使用深色主题确保白色图标和文字
        3. 提供统一的导航体验
    -->
    <com.google.android.material.appbar.AppBarLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar">

        <!-- 
            顶部工具栏
            作用：显示页面标题并提供操作按钮
            特点：
            1. 使用应用主题色作为背景
            2. 添加自定义布局实现右侧功能按钮
            3. 提供返回导航功能
            4. 支持浅色弹出菜单样式
        -->
        <androidx.appcompat.widget.Toolbar
            android:id="@+id/toolbar"
            android:layout_width="match_parent"
            android:layout_height="?attr/actionBarSize"
            android:background="?attr/colorPrimary"
            app:popupTheme="@style/ThemeOverlay.AppCompat.Light">
            
            <!-- 
                顶部工具栏右侧按钮区域
                作用：提供收藏和分享功能按钮
                特点：
                1. 水平布局靠右对齐
                2. 使用线性布局包含两个操作图标
            -->
            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:gravity="end|center_vertical"
                android:orientation="horizontal">

                <!-- 
                    收藏按钮
                    作用：将当前新闻添加到收藏列表或取消收藏
                    特点：
                    1. 使用星形图标表示收藏功能
                    2. 点击后会切换收藏状态并更新图标
                    3. 添加了无边界点击效果提升用户体验
                    4. 收藏状态会保存到数据库
                -->
                <ImageView
                    android:id="@+id/iv_favorite"
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="16dp"
                    android:background="?attr/selectableItemBackgroundBorderless"
                    android:contentDescription="@string/app_name"
                    android:src="@android:drawable/btn_star" />

                <!-- 
                    分享按钮
                    作用：分享新闻到其他应用
                    特点：
                    1. 使用系统分享图标表示功能
                    2. 点击后会调用系统分享功能
                    3. 添加了无边界点击效果提升用户体验
                -->
                <ImageView
                    android:id="@+id/iv_share"
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="16dp"
                    android:background="?attr/selectableItemBackgroundBorderless"
                    android:contentDescription="@string/app_name"
                    android:src="@android:drawable/ic_menu_share" />
            </LinearLayout>
        </androidx.appcompat.widget.Toolbar>

    </com.google.android.material.appbar.AppBarLayout>

    <!-- 
        内容滚动区域
        作用：包含新闻详细内容，支持嵌套滚动
        特点：
        1. 使用NestedScrollView支持与AppBarLayout联动
        2. 滚动行为通过app:layout_behavior属性配置
        3. 内部使用ConstraintLayout精确定位各元素
    -->
    <androidx.core.widget.NestedScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        app:layout_behavior="@string/appbar_scrolling_view_behavior">

        <androidx.constraintlayout.widget.ConstraintLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent">

            <!-- 
                新闻标题
                作用：显示新闻的完整标题
                特点：
                1. 粗体、黑色、较大字号(20sp)提升可读性
                2. 左右两侧16dp边距，顶部16dp边距
                3. 可能会多行显示，不限制行数
            -->
            <TextView
                android:id="@+id/tv_title"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_marginStart="16dp"
                android:layout_marginTop="16dp"
                android:layout_marginEnd="16dp"
                android:textColor="@android:color/black"
                android:textSize="20sp"
                android:textStyle="bold"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toTopOf="parent"
                tools:text="这是新闻标题" />

            <!-- 
                新闻来源
                作用：显示新闻的发布媒体/来源
                特点：
                1. 灰色、小字号(14sp)的次要信息样式
                2. 位于标题下方，靠左对齐
                3. 与发布日期相邻显示
            -->
            <TextView
                android:id="@+id/tv_source"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="16dp"
                android:layout_marginTop="8dp"
                android:textColor="@android:color/darker_gray"
                android:textSize="14sp"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/tv_title"
                tools:text="新华网" />

            <!-- 
                发布日期
                作用：显示新闻的发布时间
                特点：
                1. 灰色、小字号(14sp)的次要信息样式
                2. 位于标题下方，来源右侧
                3. 通常显示完整的日期和时间
            -->
            <TextView
                android:id="@+id/tv_date"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="16dp"
                android:layout_marginTop="8dp"
                android:textColor="@android:color/darker_gray"
                android:textSize="14sp"
                app:layout_constraintStart_toEndOf="@+id/tv_source"
                app:layout_constraintTop_toBottomOf="@+id/tv_title"
                tools:text="2023-04-01 12:30" />

            <!-- 
                新闻配图
                作用：显示新闻的主要配图
                特点：
                1. 全宽显示，固定高度200dp
                2. 使用centerCrop缩放模式确保填满且不变形
                3. 默认隐藏，有图片时才显示
                4. 位于来源和日期下方
            -->
            <ImageView
                android:id="@+id/iv_picture"
                android:layout_width="0dp"
                android:layout_height="200dp"
                android:layout_marginTop="16dp"
                android:contentDescription="@string/app_name"
                android:scaleType="centerCrop"
                android:visibility="gone"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/tv_source"
                tools:visibility="visible" />

            <!-- 
                新闻内容WebView
                作用：加载并显示HTML格式的新闻正文
                特点：
                1. 位于图片下方（或无图时在来源/日期下方）
                2. 占满剩余空间直到页面底部
                3. 自适应各种HTML格式内容
                4. 支持JavaScript和富文本显示
            -->
            <WebView
                android:id="@+id/web_view"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:layout_marginTop="16dp"
                app:layout_constraintBottom_toBottomOf="parent"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/iv_picture" />

        </androidx.constraintlayout.widget.ConstraintLayout>

    </androidx.core.widget.NestedScrollView>

    <!-- 
        加载进度条
        作用：在加载新闻内容时显示loading状态
        特点：
        1. 居中显示的圆形进度指示器
        2. 在WebView加载完成后自动隐藏
        3. 使用layout_gravity="center"确保居中显示
    -->
    <ProgressBar
        android:id="@+id/progress_bar"
        style="?android:attr/progressBarStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center" />

</androidx.coordinatorlayout.widget.CoordinatorLayout> 